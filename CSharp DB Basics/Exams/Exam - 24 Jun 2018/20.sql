CREATE TRIGGER tr_DeleteTrip ON Trips INSTEAD OF DELETE AS
UPDATE Trips
SET CancelDate = GETDATE()
WHERE Id IN
(SELECT Id FROM deleted)
AND CancelDate IS NULL